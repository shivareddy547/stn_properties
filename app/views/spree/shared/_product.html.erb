
<div class="row mb-3" style="border: 1px solid #ccc; border-radius: 10px; padding: 0px;">
  
  <!-- Row Header with Notification Text -->
  <div class="col-12 mb-1 p-0">
    <div class="header-notification" style="background-color: rgb(31, 54, 117); color: white; padding: 5px; text-align: center; border-radius: 10px 10px 0 0;">
      <h2 class="mb-0">Exclusive Hotel Deals - Limited Time Offer!</h2>
    </div>
  </div>

  <!-- Part 1: Image Gallery (Main Image and Thumbnail Row) -->

<div class="col-4 product">
  <% if product.images.size > 1 %>
    <div class="text-center mainImage">
      <%= image_tag(main_app.cdn_image_url(product.images[0].url(:product)), class: "main-img-thumbnail","data-toggle": "modal", id: "mainImage#{product.id}", "data-target":"#imageModal#{product.id}", "data-original-src": main_app.cdn_image_url(product.images[0].url(:product))) %>
    </div>
    
    <div class="d-flex justify-content-between align-items-center mt-3 thumbnails">
      <% product.images.first(4).each_with_index do |i, index| %>
        <%= link_to image_tag(main_app.cdn_image_url(i.url(:product)), class: "img-fluid img-fluid-thumb thumbnail-img"), "#", class: "thumbnail open-modal ", "data-product-id": product.id, "data-img-url": main_app.cdn_image_url(i.url(:product)), "data-toggle": "modal", "data-target": "#imageModal#{product.id}"%>
      <% end %>
    </div>
  <% end %>
</div>
<% @product = product %>
<% @variants = product.variants %>
<% url = spree.product_path(product, taxon_id: @taxon.try(:id)) %>
<% is_product_available_in_currency = product_available_in_currency? %>
<% default_variant = default_variant(@variants, @product) %>

<!-- Part 2: Product Details -->
<div class="col-5 product-card">
  
  <%= link_to url, style: "text-decoration: none; color: inherit;" do %>
    <!-- Hotel Name -->
    <div class="product-component-name" title="<%= product.name %>">
      <span class="product-name">
        <%= truncate(product.name, length: 50) %>
      </span>
    </div>
    
    <!-- Hotel Rating (Stars) -->
    <div class="product-rating-location">
      <span class="rating">
        <%= display_stars(product.rating) %>
      </span>

      <!-- Location with Map Icon -->
      <% if product.address.present? %>
      <span class="location">
        <i class="fas fa-location-dot fa-lg" style="margin-right: 5px; color: rgb(32, 103, 218);"></i>
        <%= product.address %>
      </span>
      <% end %>
    </div>

    <!-- Property Offers Section -->
    <div class="offers-section">
      <strong class="offers-header">
        This property offers:
      </strong>
      
      <div class="offers" style="margin-top: 5px; position: relative;">
        <% product.all_amenities.each do |amenity| %>
          <span class="offer-box">
            <%= amenity.name.humanize %>
          </span>
        <% end %>

        <% if product.all_amenities.size > 3 %>
          <span class="offer-box more">
            More
          </span>
        <% end %>
      </div>
    </div>
  <% end %>
</div>






  <!-- Dotted Line Separator -->
  <div class="col-1" style="border-left: 1px dotted #ccc; height: 100%;"></div>

  <!-- Part 3: Price Details -->
  <div class="col-2 text-right">
    <% @product = product %>
    <% @variants = product.variants %>
    <% default_variant = @variants.detect(&:is_master) || @variants.first %> <!-- Use the master variant or fallback to the first variant -->
  
    <div class="review-section" style="font-size: 16px; color: #2a6ebd;">
      <strong>8.6 Excellent</strong><br>
      <span style="font-size: 12px; color: #666;">584 reviews</span>
    </div>
    
    <% if default_variant %>
      <div class="offer-section mt-2" style="color: #d9534f;">
        <% if default_variant.cost_price.present? && default_variant.compare_at_price.present? %>
          <span style="background-color: #ff6666; color: white; padding: 5px; border-radius: 5px;">
            <% discount_percentage = ((default_variant.compare_at_price - default_variant.price) / default_variant.compare_at_price * 100).round %>
            <%= "#{discount_percentage}% OFF TODAY" %>
          </span>
          <div style="color: #f77f7f;">Price has increased</div>
        <% else %>
          <span style="color: #d9534f;">
            No discounts available
          </span>
        <% end %>
      </div>
  
      <div class="price-section mt-2">
        <% if default_variant.compare_at_price.present? && should_display_compare_at_price?(default_variant) %>
          <div style="text-decoration: line-through; font-size: 18px; color: #666;">
            <%= display_price(default_variant) %>
          </div>
          <div style="font-size: 24px; color: #d9534f;">
            <strong><%= display_compare_at_price(default_variant) %></strong>
          </div>
        <% else %>
          <div style="font-size: 24px; color: #d9534f;">
            <strong><%= display_price(default_variant) %></strong>
          </div>
        <% end %>
        
        <div style="font-size: 12px; color: #999;">Per night before taxes and fees</div>
      </div>
    <% else %>
      <div style="color: #f00;">No variants available for this product.</div>
    <% end %>
  </div>
  
</div>

<!-- <button class="btn btn-primary open-modal" data-modal-target="#productModal<%= product.id %>">View Images</button> -->

<style>
  .product-card {
    border: 1px solid #ccc;
    padding: 20px;
    border-radius: 5px;
    background-color: #fff;
    max-width: 300px;
}

.product-name {
    font-weight: bold;
    font-size: 18px;
    display: block;
    color: #333;
}

.product-rating-location {
    font-size: 14px;
    color: #666;
    margin-top: 5px;
}

.rating {
    color: rgb(181, 76, 1);
    min-width: 14px;
    min-height: 14px;
    max-width: 14px;
    max-height: 14px;
}

.location {
    display: inline-flex;
    -webkit-box-align: center;
    align-items: center;
    text-decoration: none;
    text-underline-offset: 4px;
    font-weight: 600;
    color: rgb(32, 103, 218);
    fill: rgb(32, 103, 218);
    margin-left: 5px;
    font-size: 12px;
}

.map-icon {
    width: 14px;
    height: 14px;
    margin-right: 5px;
}

.offers-header {
    font-weight: 400;
    color: rgb(37, 44, 56);
    line-height: calc(18.19px);
    font-size: 14px;
    margin-top: calc(2.81px);
    margin-bottom: calc(2.81px);
}

.offers-section {
    margin-top: 10px;
}

.offer-box {
    font-weight: 400;
    color: rgb(94, 107, 130);
    display: inline-block;
    background-color: #f8f8f8;
    border: 1px solid #ccc;
    border-radius: 5px;
    padding: 5px 10px;
    margin: 2px;
    line-height: calc(14.98px);
    font-size: 12px;
}

</style>